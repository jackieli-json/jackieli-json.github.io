<!DOCTYPE html><html class="theme-lattice"><head><meta charset="utf-8"><title>跟着老司机玩转Node命令行 | Aotu.io「凹凸实验室」</title><meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="author" content="凹凸实验室"><meta name="designer" content="凹凸实验室"><meta name="rating" content="general"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black"><meta name="format-detection" content="telephone=yes"><meta name="mobile-web-app-capable" content="yes"><meta name="robots" content="index, follow"><meta name="keywords" content="老司机,前端工程化,命令行,NodeJS,凹凸实验室,Aotu,前端开发,全栈开发,IOS开发,Android开发"><link rel="canonical" href="https://aotu.io/notes/2016/08/09/command-line-development/index.html"><link rel="apple-touch-icon" sizes="57x57" href="/img/apple-touch-icon-57x57.png"><link rel="apple-touch-icon" sizes="114x114" href="/img/apple-touch-icon-114x114.png"><link rel="apple-touch-icon" sizes="72x72" href="/img/apple-touch-icon-72x72.png"><link rel="apple-touch-icon" sizes="144x144" href="/img/apple-touch-icon-144x144.png"><link rel="apple-touch-icon" sizes="60x60" href="/img/apple-touch-icon-60x60.png"><link rel="apple-touch-icon" sizes="120x120" href="/img/apple-touch-icon-120x120.png"><link rel="apple-touch-icon" sizes="76x76" href="/img/apple-touch-icon-76x76.png"><link rel="apple-touch-icon" sizes="152x152" href="/img/apple-touch-icon-152x152.png"><link rel="icon" type="image/png" href="/img/favicon-230x230.png" sizes="230x230"><link rel="icon" type="image/png" href="/img/favicon-96x96.png" sizes="96x96"><link rel="icon" type="image/png" href="/img/favicon-16x16.png" sizes="16x16"><link rel="icon" type="image/png" href="/img/favicon-32x32.png" sizes="32x32"><meta name="msapplication-TileColor" content="#2f83cd"><meta name="msapplication-TileImage" content="/img/mstile-144x144.png"><link rel="stylesheet" href="/css/style.css"><link rel="alternate" href="/atom.xml" title="Aotu.io"><meta name="description" content="当我们使用Node.js原生开发命令行程序时或许会有一定的门槛，但通过依赖一些开源模块却能够帮助我们简化命令行开发，从而达到事半功倍的效果。本文主要通过一些示例来演示commander.js、inquirer.js的一些基本玩法。下面老司机将带着我，我带着大家一起来玩转Node命令行吧！
温馨提示
本文部分代码参考自凹凸实验室前端流程工具 athena
本文需要一点Node基础
本文涉及到一些es"><meta property="og:type" content="article"><meta property="og:title" content="跟着老司机玩转Node命令行"><meta property="og:url" content="https://aotu.io/notes/2016/08/09/command-line-development/index.html"><meta property="og:site_name" content="Aotu.io"><meta property="og:description" content="当我们使用Node.js原生开发命令行程序时或许会有一定的门槛，但通过依赖一些开源模块却能够帮助我们简化命令行开发，从而达到事半功倍的效果。本文主要通过一些示例来演示commander.js、inquirer.js的一些基本玩法。下面老司机将带着我，我带着大家一起来玩转Node命令行吧！
温馨提示
本文部分代码参考自凹凸实验室前端流程工具 athena
本文需要一点Node基础
本文涉及到一些es"><meta property="og:image" content="https://aotu.io//misc.aotu.io/yangzicheng/command-line-development/command-line-development_8.jpg"><meta property="og:image" content="https://aotu.io//misc.aotu.io/yangzicheng/command-line-development/command-line-development_1.jpg"><meta property="og:image" content="https://aotu.io//misc.aotu.io/yangzicheng/command-line-development/command-line-development_9.jpg"><meta property="og:image" content="https://aotu.io//misc.aotu.io/yangzicheng/command-line-development/command-line-development_10.jpg"><meta property="og:image" content="https://aotu.io//misc.aotu.io/yangzicheng/command-line-development/command-line-development_11.jpg"><meta property="og:image" content="https://aotu.io//misc.aotu.io/yangzicheng/command-line-development/command-line-development_12.jpg"><meta property="og:image" content="https://aotu.io//misc.aotu.io/yangzicheng/command-line-development/command-line-development_2.jpg"><meta property="og:image" content="https://aotu.io//misc.aotu.io/yangzicheng/command-line-development/command-line-development_3.jpg"><meta property="og:image" content="https://aotu.io//misc.aotu.io/yangzicheng/command-line-development/command-line-development_16.jpg"><meta property="og:image" content="https://aotu.io//misc.aotu.io/yangzicheng/command-line-development/command-line-development_9.jpg"><meta property="og:image" content="https://aotu.io//misc.aotu.io/yangzicheng/command-line-development/command-line-development_4.jpg"><meta property="og:image" content="https://aotu.io//misc.aotu.io/yangzicheng/command-line-development/command-line-development_5.jpg"><meta property="og:image" content="https://aotu.io//misc.aotu.io/yangzicheng/command-line-development/command-line-development_14.jpg"><meta property="og:image" content="https://aotu.io//misc.aotu.io/yangzicheng/command-line-development/command-line-development_15.jpg"><meta property="og:updated_time" content="2016-10-20T07:06:32.447Z"><meta name="twitter:card" content="summary"><meta name="twitter:title" content="跟着老司机玩转Node命令行"><meta name="twitter:description" content="当我们使用Node.js原生开发命令行程序时或许会有一定的门槛，但通过依赖一些开源模块却能够帮助我们简化命令行开发，从而达到事半功倍的效果。本文主要通过一些示例来演示commander.js、inquirer.js的一些基本玩法。下面老司机将带着我，我带着大家一起来玩转Node命令行吧！
温馨提示
本文部分代码参考自凹凸实验室前端流程工具 athena
本文需要一点Node基础
本文涉及到一些es"><meta name="twitter:image" content="https://aotu.io//misc.aotu.io/yangzicheng/command-line-development/command-line-development_8.jpg"><meta name="twitter:site" content="o2circle"><script>var App={root:"/",isHome:!1,isCate:!1,isTag:!1}</script></head><body class="page-post-detail"><div class="mod-hd"><div class="grid"><div class="mod-logo"><a href="/index.html" title="Aotu.io">Aotu.io</a></div><span class="mod-hd-toggle" id="J_hdToggle"><i class="fa fa-bars"></i></span><div class="mod-hd-main"><div class="mod-hd-inner"><nav class="mod-nav"><ul class="mod-nav-list"><li class="main-nav-item"><a href="/index.html" class="main-nav-link">首页</a></li><li class="main-nav-item"><a href="/about/" class="main-nav-link">关于</a></li><li class="main-nav-item"><a href="/join/" class="main-nav-link">加入我们</a></li></ul></nav><div class="mod-search"><a class="fa fa-search mod-search-ico" id="J_searchTrigger" title="搜索"></a><form id="J_searchForm" method="get" class="mod-search-form" action="/search/"><input type="text" name="query" class="mod-search-ipt" id="J_searchInput" placeholder="搜索"></form></div></div></div></div></div><div class="mod-container"><div class="grid"><div class="mod-main"><article class="post"><header class="post-hd"><h2 class="post-tit">跟着老司机玩转Node命令行</h2><div class="post-meta">by <a target="_blank" href="https://github.com/yangzicheng" class="post-author">自成</a> on <span>2016-08-09</span></div><p class="post-subtit" style="display:none"><i class="fa fa-quote-left"></i>对于一些没有接触过的东西，或许会因为它的神秘而觉得遥不可及...</p><span style="display:none" id="busuanzi_value_page_pv"></span></header><div class="post-cover"><img src="//misc.aotu.io/yangzicheng/command-line-development/command-line-development_900_500.jpg" alt="跟着老司机玩转Node命令行"></div><div class="post-content"><p>当我们使用Node.js原生开发命令行程序时或许会有一定的门槛，但通过依赖一些开源模块却能够帮助我们简化命令行开发，从而达到事半功倍的效果。本文主要通过一些示例来演示commander.js、inquirer.js的一些基本玩法。下面老司机将带着我，我带着大家一起来玩转Node命令行吧！</p><h2 id="温馨提示" class="post-heading"><a href="#温馨提示" class="headerlink" title="温馨提示"></a>温馨提示<a class="post-anchor" href="#温馨提示" aria-hidden="true"></a></h2><ul><li>本文部分代码参考自凹凸实验室前端流程工具 <a href="https://github.com/o2team/athena" target="_blank" rel="external">athena</a></li><li>本文需要一点Node基础</li><li>本文涉及到一些es6语法，并且请确保Node版本在4.0及以上</li><li>不属于本文的知识点一秒带过哈</li></ul><p><img src="//misc.aotu.io/yangzicheng/command-line-development/command-line-development_8.jpg" alt=""></p><h2 id="基础准备" class="post-heading"><a href="#基础准备" class="headerlink" title="基础准备"></a>基础准备<a class="post-anchor" href="#基础准备" aria-hidden="true"></a></h2><p>1.新建一个项目，打开cmd命令，执行npm init,创建package.json<br>2.在根目录下创建一个不带后缀的系统文件，作为主入口文件<br>3.安装本文所涉及到的模块commander、inquirer、chalk，在根目录下执行 npm install commander inquirer chalk –save-dev,这时候会看到根目录下多了一个node_modules目录，里面有刚刚安装的几个模块，package.json里面devDependencies依赖了这几个模块，如下图</p><p><strong>根目录</strong><br><img src="//misc.aotu.io/yangzicheng/command-line-development/command-line-development_1.jpg" alt=""></p><p><strong>package.json</strong><br></p><figure class="highlight json"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">  <span class="attr">"name"</span>: <span class="string">"app"</span>,</div><div class="line">  <span class="attr">"version"</span>: <span class="string">"1.0.0"</span>,</div><div class="line">  <span class="attr">"description"</span>: <span class="string">"玩转命令行开发"</span>,</div><div class="line">  <span class="attr">"main"</span>: <span class="string">"index.js"</span>,</div><div class="line">  <span class="attr">"scripts"</span>: &#123;</div><div class="line">    <span class="attr">"test"</span>: <span class="string">"echo \"Error: no test specified\" &amp;&amp; exit 1"</span></div><div class="line">  &#125;,</div><div class="line">  <span class="attr">"author"</span>: <span class="string">"ykg"</span>,</div><div class="line">  <span class="attr">"license"</span>: <span class="string">"ISC"</span>,</div><div class="line">  <span class="attr">"devDependencies"</span>: &#123;</div><div class="line">    <span class="attr">"chalk"</span>: <span class="string">"^1.1.3"</span>,</div><div class="line">    <span class="attr">"commander"</span>: <span class="string">"^2.9.0"</span>,</div><div class="line">    <span class="attr">"inquirer"</span>: <span class="string">"^1.1.2"</span></div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><p></p><h2 id="主体内容" class="post-heading"><a href="#主体内容" class="headerlink" title="主体内容"></a>主体内容<a class="post-anchor" href="#主体内容" aria-hidden="true"></a></h2><p>我们先来认识一下commander吧</p><h3 id="commander-简介" class="post-heading"><a href="#commander-简介" class="headerlink" title="commander 简介"></a>commander 简介<a class="post-anchor" href="#commander-简介" aria-hidden="true"></a></h3><p>呃~~官方时刻到了哈：commander灵感来自 Ruby，它提供了用户命令行输入和参数解析的强大功能，可以帮助我们简化命令行开发。<br>根据其官方的描述，具有以下特性:</p><ul><li>参数解析</li><li>强制多态</li><li>可变参数</li><li>Git 风格的子命令</li><li>自动化帮助信息</li><li>自定义帮助等</li></ul><p><img src="//misc.aotu.io/yangzicheng/command-line-development/command-line-development_9.jpg" alt=""></p><h3 id="一个简单的实例" class="post-heading"><a href="#一个简单的实例" class="headerlink" title="一个简单的实例"></a>一个简单的实例<a class="post-anchor" href="#一个简单的实例" aria-hidden="true"></a></h3><p>下面我们通过一个简单的实例来了解一下它的基本语法吧<br></p><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> program = <span class="built_in">require</span>(<span class="string">'commander'</span>)</div><div class="line"><span class="keyword">const</span> inquirer = <span class="built_in">require</span>(<span class="string">'inquirer'</span>)</div><div class="line"><span class="keyword">const</span> chalk = <span class="built_in">require</span>(<span class="string">'chalk'</span>)</div><div class="line"></div><div class="line">program</div><div class="line">    .command(<span class="string">'module'</span>)</div><div class="line">    .alias(<span class="string">'m'</span>)</div><div class="line">    .description(<span class="string">'创建新的模块'</span>)</div><div class="line">    .option(<span class="string">'-a, --name [moduleName]'</span>, <span class="string">'模块名称'</span>)</div><div class="line">    .action(<span class="function"><span class="params">option</span> =&gt;</span> &#123;</div><div class="line">        <span class="built_in">console</span>.log(<span class="string">'Hello World'</span>)</div><div class="line">        <span class="comment">//为什么是Hello World 给你个眼神，自己去体会...</span></div><div class="line">    &#125;)</div><div class="line">    </div><div class="line">program.parse(process.argv)</div></pre></td></tr></table></figure><p></p><p>执行一下看看效果吧！$ node app.js app (请各位看官自行体会这种执行方式哈)<br>//输出结果 Hello World</p><h3 id="全局方式运行" class="post-heading"><a href="#全局方式运行" class="headerlink" title="全局方式运行"></a>全局方式运行<a class="post-anchor" href="#全局方式运行" aria-hidden="true"></a></h3><p>我们可以通过一些配置，然后以 <strong>模块名 + command</strong>的方式运行，实现这种方式分三步走：</p><p><img src="//misc.aotu.io/yangzicheng/command-line-development/command-line-development_10.jpg" alt=""></p><ul><li><p>配置package.json的bin字段。bin字段有啥用呢？它可以用来<strong>存放一个可执行的文件</strong>，如下配置所示</p><figure class="highlight xquery"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="string">"bin"</span>: &#123;</div><div class="line">    <span class="string">"app"</span>: <span class="string">"app"</span></div><div class="line"> &#125;</div></pre></td></tr></table></figure></li><li><p>执行npm link。它将会把<strong>app</strong>这个字段复制到npm的全局模块安装文件夹node_modules内，并创建符号链接（symbolic link，软链接），也就是<strong>将 app 的路径加入环境变量 PATH</strong></p></li><li>在主入口文件的最上方添加代码 <strong>#! /usr/bin/env node</strong>, 表明这是一个可执行的应用，如下所示<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#! /usr/bin/env node </span></div><div class="line"></div><div class="line"><span class="keyword">const</span> program = <span class="built_in">require</span>(<span class="string">'commander'</span>)</div><div class="line"><span class="keyword">const</span> inquirer = <span class="built_in">require</span>(<span class="string">'inquirer'</span>)</div><div class="line"><span class="keyword">const</span> chalk = <span class="built_in">require</span>(<span class="string">'chalk'</span>)</div><div class="line"></div><div class="line">program</div><div class="line">    .command(<span class="string">'module'</span>)</div><div class="line">    .alias(<span class="string">'m'</span>)</div><div class="line">    .description(<span class="string">'创建新的模块'</span>)</div><div class="line">    .option(<span class="string">'-a, --name [moduleName]'</span>, <span class="string">'模块名称'</span>)</div><div class="line">    .action(<span class="function"><span class="params">option</span> =&gt;</span> &#123;</div><div class="line">        <span class="built_in">console</span>.log(<span class="string">'Hello World'</span>)</div><div class="line">    &#125;)</div><div class="line">    </div><div class="line">program.parse(process.argv)</div></pre></td></tr></table></figure></li></ul><p>做好了以上三步后，然后运行$ app module<br>//输出结果 Hello World</p><p><img src="//misc.aotu.io/yangzicheng/command-line-development/command-line-development_11.jpg" alt=""></p><h3 id="commander-API" class="post-heading"><a href="#commander-API" class="headerlink" title="commander API"></a>commander API<a class="post-anchor" href="#commander-API" aria-hidden="true"></a></h3><p>我们逐个来看看各个属性的功能，一看秒懂哦</p><ul><li><strong>command</strong> – 定义命令行指令，后面可跟上一个name，用空格隔开，如 .command( ‘app [name] ‘)</li><li><strong>alias</strong> – 定义一个更短的命令行指令 ，如执行命令<strong>$ app m</strong> 与之是等价的</li><li><strong>description</strong> – 描述，它会在help里面展示</li><li><strong>option</strong> – 定义参数。它接受四个参数，在第一个参数中，它可输入短名字 -a和长名字–app ,使用 <strong>|</strong> 或者<strong>,</strong>分隔，在命令行里使用时，这两个是等价的，区别是后者可以在程序里通过回调获取到；第二个为描述, 会在 help 信息里展示出来；第三个参数为回调函数，他接收的参数为一个string，有时候我们需要一个命令行创建多个模块，就需要一个回调来处理；第四个参数为默认值</li><li><strong>action</strong> – 注册一个callback函数,这里需注意<strong>目前回调不支持let声明变量</strong></li><li><strong>parse</strong> – 解析命令行</li></ul><p><img src="//misc.aotu.io/yangzicheng/command-line-development/command-line-development_12.jpg" alt=""></p><h3 id="生成帮助信息" class="post-heading"><a href="#生成帮助信息" class="headerlink" title="生成帮助信息"></a>生成帮助信息<a class="post-anchor" href="#生成帮助信息" aria-hidden="true"></a></h3><h4 id="自动生成" class="post-heading"><a href="#自动生成" class="headerlink" title="自动生成"></a>自动生成<a class="post-anchor" href="#自动生成" aria-hidden="true"></a></h4><p>执行 $ app m –help</p><p><img src="//misc.aotu.io/yangzicheng/command-line-development/command-line-development_2.jpg" alt=""></p><p>它会自动将description、option的信息显示在help中</p><h4 id="自定义生成" class="post-heading"><a href="#自定义生成" class="headerlink" title="自定义生成"></a>自定义生成<a class="post-anchor" href="#自定义生成" aria-hidden="true"></a></h4><p>我们也可以通过自定义的方式生成帮助信息<br></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> program = <span class="built_in">require</span>(<span class="string">'commander'</span>)</div><div class="line"><span class="keyword">const</span> inquirer = <span class="built_in">require</span>(<span class="string">'inquirer'</span>)</div><div class="line"><span class="keyword">const</span> chalk = <span class="built_in">require</span>(<span class="string">'chalk'</span>)</div><div class="line"></div><div class="line">program</div><div class="line">    .command(<span class="string">'module [moduleName]'</span>)</div><div class="line">    .alias(<span class="string">'m'</span>)</div><div class="line">    .description(<span class="string">'创建新的项目'</span>)</div><div class="line">    .option(<span class="string">'-a, --name [moduleName]'</span>, <span class="string">'模块名称'</span>)</div><div class="line">    .action(<span class="function"><span class="params">option</span> =&gt;</span> &#123;</div><div class="line">        <span class="built_in">console</span>.log(<span class="string">'Hello World'</span>)</div><div class="line">    &#125;)</div><div class="line">    <span class="comment">//自定义帮助信息</span></div><div class="line">    .on(<span class="string">'--help'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">        <span class="built_in">console</span>.log(<span class="string">'  Examples:'</span>)</div><div class="line">        <span class="built_in">console</span>.log(<span class="string">''</span>)</div><div class="line">        <span class="built_in">console</span>.log(<span class="string">'$ app module moduleName'</span>)</div><div class="line">        <span class="built_in">console</span>.log(<span class="string">'$ app m moduleName'</span>)</div><div class="line">    &#125;)</div><div class="line">    </div><div class="line">program.parse(process.argv)</div></pre></td></tr></table></figure><p></p><p>执行$ app m –help</p><p><img src="//misc.aotu.io/yangzicheng/command-line-development/command-line-development_3.jpg" alt=""></p><h3 id="inquirer" class="post-heading"><a href="#inquirer" class="headerlink" title="inquirer"></a>inquirer<a class="post-anchor" href="#inquirer" aria-hidden="true"></a></h3><p>在开发的过程中，我们需要频繁的跟命令行进行交互，借助<strong>inquirer</strong>这个模块就能轻松实现，它提供了用户界面和查询会话流程。它的语法是这样的（直接从<a href="https://www.npmjs.com/package/inquirer" target="_blank" rel="external">官方</a>拷贝~~）<br><img src="//misc.aotu.io/yangzicheng/command-line-development/command-line-development_16.jpg" alt=""></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> inquirer = <span class="built_in">require</span>(<span class="string">'inquirer'</span>)</div><div class="line">inquirer.prompt([<span class="comment">/* Pass your questions in here */</span>]).then(<span class="function"><span class="keyword">function</span> (<span class="params">answers</span>) </span>&#123;</div><div class="line">    <span class="comment">// Use user feedback for... whatever!! </span></div><div class="line">&#125;)</div></pre></td></tr></table></figure><p>需注意在旧的语法中，采用的是传统的function回调<br></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> inquirer = <span class="built_in">require</span>(<span class="string">'inquirer'</span>)</div><div class="line">inquirer.prompt([<span class="comment">/* Pass your questions in here */</span>], <span class="function"><span class="keyword">function</span> (<span class="params">answers</span>) </span>&#123;</div><div class="line">    <span class="comment">// Use user feedback for... whatever!! </span></div><div class="line">&#125;)</div></pre></td></tr></table></figure><p></p><h4 id="inquirer功能简介" class="post-heading"><a href="#inquirer功能简介" class="headerlink" title="inquirer功能简介"></a>inquirer功能简介<a class="post-anchor" href="#inquirer功能简介" aria-hidden="true"></a></h4><ul><li>input–输入</li><li>validate–验证</li><li>list–列表选项</li><li>confirm–提示</li><li>checkbox–复选框等等</li></ul><p><img src="//misc.aotu.io/yangzicheng/command-line-development/command-line-development_9.jpg" alt=""></p><p>这个模块相当简单，看个栗子就全明白了</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#! /usr/bin/env node </span></div><div class="line"></div><div class="line"><span class="keyword">const</span> program = <span class="built_in">require</span>(<span class="string">'commander'</span>)</div><div class="line"><span class="keyword">const</span> inquirer = <span class="built_in">require</span>(<span class="string">'inquirer'</span>)</div><div class="line"><span class="keyword">const</span> _ = <span class="built_in">require</span>(<span class="string">'lodash'</span>)</div><div class="line"><span class="keyword">const</span> chalk = <span class="built_in">require</span>(<span class="string">'chalk'</span>)</div><div class="line"></div><div class="line">program</div><div class="line">    .command(<span class="string">'module'</span>)</div><div class="line">    .alias(<span class="string">'m'</span>)</div><div class="line">    .description(<span class="string">'创建新的模块'</span>)</div><div class="line">    .option(<span class="string">'--name [moduleName]'</span>)</div><div class="line">    .option(<span class="string">'--sass'</span>, <span class="string">'启用sass'</span>)</div><div class="line">    .option(<span class="string">'--less'</span>, <span class="string">'启用less'</span>)</div><div class="line">    .action(<span class="function"><span class="params">option</span> =&gt;</span> &#123;</div><div class="line">        <span class="keyword">var</span> config = _.assign(&#123;</div><div class="line">            <span class="attr">moduleName</span>: <span class="literal">null</span>,</div><div class="line">            <span class="attr">description</span>: <span class="string">''</span>,</div><div class="line">            <span class="attr">sass</span>: <span class="literal">false</span>,</div><div class="line">            <span class="attr">less</span>: <span class="literal">false</span></div><div class="line">        &#125;, option)</div><div class="line">        <span class="keyword">var</span> promps = []</div><div class="line"></div><div class="line">        <span class="keyword">if</span>(config.moduleName !== <span class="string">'string'</span>) &#123;</div><div class="line">              promps.push(&#123;</div><div class="line">                <span class="attr">type</span>: <span class="string">'input'</span>,</div><div class="line">                <span class="attr">name</span>: <span class="string">'moduleName'</span>,</div><div class="line">                <span class="attr">message</span>: <span class="string">'请输入模块名称'</span>,</div><div class="line">                <span class="attr">validate</span>: <span class="function"><span class="keyword">function</span> (<span class="params">input</span>)</span>&#123;</div><div class="line">                    <span class="keyword">if</span>(!input) &#123;</div><div class="line">                        <span class="keyword">return</span> <span class="string">'不能为空'</span></div><div class="line">                    &#125;</div><div class="line">                    <span class="keyword">return</span> <span class="literal">true</span></div><div class="line">                &#125;</div><div class="line">              &#125;)</div><div class="line">        &#125; </div><div class="line"></div><div class="line">        <span class="keyword">if</span>(config.description !== <span class="string">'string'</span>) &#123;</div><div class="line">            promps.push(&#123;</div><div class="line">                <span class="attr">type</span>: <span class="string">'input'</span>,</div><div class="line">                <span class="attr">name</span>: <span class="string">'moduleDescription'</span>,</div><div class="line">                <span class="attr">message</span>: <span class="string">'请输入模块描述'</span></div><div class="line">            &#125;)</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="keyword">if</span>(config.sass === <span class="literal">false</span> &amp;&amp; config.less === <span class="literal">false</span>) &#123;</div><div class="line">          promps.push(&#123;</div><div class="line">            <span class="attr">type</span>: <span class="string">'list'</span>,</div><div class="line">            <span class="attr">name</span>: <span class="string">'cssPretreatment'</span>,</div><div class="line">            <span class="attr">message</span>: <span class="string">'想用什么css预处理器呢'</span>,</div><div class="line">            <span class="attr">choices</span>: [</div><div class="line">              &#123;</div><div class="line">                <span class="attr">name</span>: <span class="string">'Sass/Compass'</span>,</div><div class="line">                <span class="attr">value</span>: <span class="string">'sass'</span></div><div class="line">              &#125;,</div><div class="line">              &#123;</div><div class="line">                <span class="attr">name</span>: <span class="string">'Less'</span>,</div><div class="line">                <span class="attr">value</span>: <span class="string">'less'</span></div><div class="line">              &#125;</div><div class="line">            ]</div><div class="line">          &#125;)</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        inquirer.prompt(promps).then(<span class="function"><span class="keyword">function</span> (<span class="params">answers</span>) </span>&#123;</div><div class="line">            <span class="built_in">console</span>.log(answers)</div><div class="line">        &#125;)</div><div class="line">    &#125;)</div><div class="line">    .on(<span class="string">'--help'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">        <span class="built_in">console</span>.log(<span class="string">'  Examples:'</span>)</div><div class="line">        <span class="built_in">console</span>.log(<span class="string">''</span>)</div><div class="line">        <span class="built_in">console</span>.log(<span class="string">'$ app module moduleName'</span>)</div><div class="line">        <span class="built_in">console</span>.log(<span class="string">'$ app m moduleName'</span>)</div><div class="line">    &#125;) </div><div class="line"></div><div class="line">program.parse(process.argv)</div></pre></td></tr></table></figure><p>执行命令 $ app m</p><p><img src="//misc.aotu.io/yangzicheng/command-line-development/command-line-development_4.jpg" alt=""></p><p>以上为了代码组织方便使用了一个promps数组来接收参数以及借助了<strong>lodash</strong>模块的<strong>assign</strong>方法用来合并对象，lodash不属于本章的知识点哈，这里给大家提供一个<a href="http://www.kancloud.cn/wizardforcel/lodash-doc-45/144108" target="_blank" rel="external">中文API文档</a>仅供大家学习参考</p><h3 id="chalk" class="post-heading"><a href="#chalk" class="headerlink" title="chalk"></a>chalk<a class="post-anchor" href="#chalk" aria-hidden="true"></a></h3><p>最后我们引入<a href="https://www.npmjs.com/package/chalk" target="_blank" rel="external">chalk</a>这个<strong>美化命令行</strong>的模块，它具有轻量级、高性能、学习成本低等特点。继续在以上栗子中引入chalk进行输出</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#! /usr/bin/env node </span></div><div class="line"></div><div class="line"><span class="keyword">const</span> program = <span class="built_in">require</span>(<span class="string">'commander'</span>)</div><div class="line"><span class="keyword">const</span> inquirer = <span class="built_in">require</span>(<span class="string">'inquirer'</span>)</div><div class="line"><span class="keyword">const</span> _ = <span class="built_in">require</span>(<span class="string">'lodash'</span>)</div><div class="line"><span class="keyword">const</span> chalk = <span class="built_in">require</span>(<span class="string">'chalk'</span>)</div><div class="line"></div><div class="line">program</div><div class="line">    .command(<span class="string">'module'</span>)</div><div class="line">    .alias(<span class="string">'m'</span>)</div><div class="line">    .description(<span class="string">'创建新的模块'</span>)</div><div class="line">    .option(<span class="string">'--name [moduleName]'</span>)</div><div class="line">    .option(<span class="string">'--sass'</span>, <span class="string">'启用sass'</span>)</div><div class="line">    .option(<span class="string">'--less'</span>, <span class="string">'启用less'</span>)</div><div class="line">    .action(<span class="function"><span class="params">option</span> =&gt;</span> &#123;</div><div class="line">        <span class="keyword">var</span> config = _.assign(&#123;</div><div class="line">            <span class="attr">moduleName</span>: <span class="literal">null</span>,</div><div class="line">            <span class="attr">description</span>: <span class="string">''</span>,</div><div class="line">            <span class="attr">sass</span>: <span class="literal">false</span>,</div><div class="line">            <span class="attr">less</span>: <span class="literal">false</span></div><div class="line">        &#125;, option)</div><div class="line">        <span class="keyword">var</span> promps = []</div><div class="line">        </div><div class="line">        <span class="built_in">console</span>.log(<span class="string">''</span>)</div><div class="line">        <span class="built_in">console</span>.log(chalk.red(<span class="string">'开启前端工程化之路'</span>))     </div><div class="line">        <span class="built_in">console</span>.log(<span class="string">''</span>)</div><div class="line">        </div><div class="line">        <span class="keyword">if</span>(config.moduleName !== <span class="string">'string'</span>) &#123;</div><div class="line">              promps.push(&#123;</div><div class="line">                <span class="attr">type</span>: <span class="string">'input'</span>,</div><div class="line">                <span class="attr">name</span>: <span class="string">'moduleName'</span>,</div><div class="line">                <span class="attr">message</span>: <span class="string">'请输入模块名称'</span>,</div><div class="line">                <span class="attr">validate</span>: <span class="function"><span class="keyword">function</span> (<span class="params">input</span>)</span>&#123;</div><div class="line">                    <span class="keyword">if</span>(!input) &#123;</div><div class="line">                        <span class="keyword">return</span> <span class="string">'不能为空'</span></div><div class="line">                    &#125;</div><div class="line">                    <span class="keyword">return</span> <span class="literal">true</span></div><div class="line">                &#125;</div><div class="line">              &#125;)</div><div class="line">        &#125; </div><div class="line"></div><div class="line">        <span class="keyword">if</span>(config.description !== <span class="string">'string'</span>) &#123;</div><div class="line">            promps.push(&#123;</div><div class="line">                <span class="attr">type</span>: <span class="string">'input'</span>,</div><div class="line">                <span class="attr">name</span>: <span class="string">'moduleDescription'</span>,</div><div class="line">                <span class="attr">message</span>: <span class="string">'请输入模块描述'</span></div><div class="line">            &#125;)</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="keyword">if</span>(config.sass === <span class="literal">false</span> &amp;&amp; config.less ===<span class="literal">false</span>) &#123;</div><div class="line">          promps.push(&#123;</div><div class="line">            <span class="attr">type</span>: <span class="string">'list'</span>,</div><div class="line">            <span class="attr">name</span>: <span class="string">'cssPretreatment'</span>,</div><div class="line">            <span class="attr">message</span>: <span class="string">'想用什么css预处理器呢'</span>,</div><div class="line">            <span class="attr">choices</span>: [</div><div class="line">              &#123;</div><div class="line">                <span class="attr">name</span>: <span class="string">'Sass/Compass'</span>,</div><div class="line">                <span class="attr">value</span>: <span class="string">'sass'</span></div><div class="line">              &#125;,</div><div class="line">              &#123;</div><div class="line">                <span class="attr">name</span>: <span class="string">'Less'</span>,</div><div class="line">                <span class="attr">value</span>: <span class="string">'less'</span></div><div class="line">              &#125;</div><div class="line">            ]</div><div class="line">          &#125;)</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        inquirer.prompt(promps).then(<span class="function"><span class="keyword">function</span> (<span class="params">answers</span>) </span>&#123;</div><div class="line">            <span class="built_in">console</span>.log(chalk.green(<span class="string">'收工咯'</span>))</div><div class="line">            <span class="built_in">console</span>.log(chalk.blue(<span class="string">'收工咯'</span>))</div><div class="line">            <span class="built_in">console</span>.log(chalk.blue.bgRed(<span class="string">'收工咯'</span>)) <span class="comment">//支持设置背景</span></div><div class="line">            <span class="built_in">console</span>.log(chalk.blue(answers))</div><div class="line">        &#125;)</div><div class="line">    &#125;) </div><div class="line">    .on(<span class="string">'--help'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">        <span class="built_in">console</span>.log(<span class="string">'  Examples:'</span>)</div><div class="line">        <span class="built_in">console</span>.log(<span class="string">''</span>)</div><div class="line">        <span class="built_in">console</span>.log(<span class="string">'$ app module moduleName'</span>)</div><div class="line">        <span class="built_in">console</span>.log(<span class="string">'$ app m moduleName'</span>)</div><div class="line">    &#125;)</div><div class="line"></div><div class="line">program.parse(process.argv)</div></pre></td></tr></table></figure><p>执行命令 $ app m</p><p><img src="//misc.aotu.io/yangzicheng/command-line-development/command-line-development_5.jpg" alt=""></p><p>正如你所看到的输出结果，本篇文章收工咯，是不是so easy！</p><p><img src="//misc.aotu.io/yangzicheng/command-line-development/command-line-development_14.jpg" alt=""></p><blockquote><p>曾经在很长一段时间里，我一直不知道他们口中的老司机究竟是个什么梗。后来随着时间的拉长，以及在现实生活中对这个词所出现语境的理解，我的潜意识一度将它理解成了一个<img src="//misc.aotu.io/yangzicheng/command-line-development/command-line-development_15.jpg" alt="">的词汇(咦，这里咋显示不出来呢)…后来才知道真正的老司机指的是<strong>在各个网站、论坛里接触时间比较长，熟悉站内各种规则、内容以及技术、玩法，并且掌握着一定资源的老手，亦指在某些方面熟门熟路，资历较老，见识广，经验足的人…</strong></p></blockquote><h2 id="参考文献" class="post-heading"><a href="#参考文献" class="headerlink" title="参考文献"></a>参考文献<a class="post-anchor" href="#参考文献" aria-hidden="true"></a></h2><p>凹凸实验室前端流程工具: <a href="https://github.com/o2team/athena" target="_blank" rel="external">https://github.com/o2team/athena</a><br>博文: <a href="http://www.tuicool.com/articles/ZFNZjq" target="_blank" rel="external">http://www.tuicool.com/articles/ZFNZjq</a><br>commander: <a href="https://www.npmjs.com/package/commander" target="_blank" rel="external">https://www.npmjs.com/package/commander</a><br>inquirer: <a href="https://www.npmjs.com/package/inquirer" target="_blank" rel="external">https://www.npmjs.com/package/inquirer</a><br>chalk: <a href="https://www.npmjs.com/package/chalk" target="_blank" rel="external">https://www.npmjs.com/package/chalk</a><br>示例源码: <a href="https://github.com/yangzicheng/command-line" target="_blank" rel="external">https://github.com/yangzicheng/command-line</a></p><div class="post-tags" style="display:none"><a href="/tags/NodeJS/">NodeJS</a> <a href="/tags/命令行/">命令行</a> <a href="/tags/前端工程化/">前端工程化</a> <a href="/tags/老司机/">老司机</a></div><div class="post-categories" style="display:none"><a href="/cates/NodeJS/">NodeJS</a></div><div class="post-announce">感谢您的阅读，本文由 <a href="//aotu.io">凹凸实验室</a> 版权所有。如若转载，请注明出处：凹凸实验室（<a href="https://aotu.io/notes/2016/08/09/command-line-development/">https://aotu.io/notes/2016/08/09/command-line-development/</a>）</div><div class="post-revision"><i class="fa fa-clock-o"></i> <time class="post-updated" datetime="2016-10-20T07:06:32.447Z">上次更新：2016-10-20 15:06:32</time></div></div><div class="post-nav"><div class="post-nav-next"><a href="/notes/2016/08/16/nginx-https/" title="Nginx 配置 HTTPS 服务器">Nginx 配置 HTTPS 服务器 <i class="fa fa-chevron-right"></i></a></div><div class="post-nav-prev"><a href="/notes/2016/08/05/robot-design-school/" title="带机器人上设计学校"><i class="fa fa-chevron-left"></i> 带机器人上设计学校</a></div></div><div class="post-comments" id="comments"><div class="ds-thread" data-thread-key="bm90ZXMvMjAxNi8wOC8wOS9jb21tYW5kLWxpbmUtZGV2ZWxvcG1lbnQv" data-title="跟着老司机玩转Node命令行" data-url="https://aotu.io/notes/2016/08/09/command-line-development/index.html"></div><script type="text/javascript">var duoshuoQuery={short_name:"aotu"};!function(){var t=document.createElement("script");t.id="duoshuo-script",t.type="text/javascript",t.async=!0,t.src=("https:"==document.location.protocol?"https:":"http:")+"//static.duoshuo.com/embed.js",t.charset="UTF-8",(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(t)}()</script></div></article></div><aside class="mod-side" id="sidebar"><div class="mod-side-sec aotuwx"><img class="aotuwx-qrcode" src="/img/qrcode.jpg" alt="关注我们"><div class="aotuwx-slogan">每周五推送精选技术文章</div></div><div class="mod-side-sec works"><div class="mod-side-sec-hd"><h2>服务/产品</h2></div><div class="mod-side-sec-bd"><ul class="mod-side-list"><li><a href="//cases.aotu.io/mobi/maga.html" target="_blank" title="拇指期刊">拇指期刊</a></li><li><a href="//athena.aotu.io/" target="_blank" title="Athena">Athena</a></li><li><a href="//guide.aotu.io/" target="_blank" title="前端代码规范">前端代码规范</a></li><li><a href="//halojs.aotu.io/" target="_blank" title="HaloJS">HaloJS</a></li><li><a href="//sign.aotu.io/" target="_blank" title="邮件签名工具">邮件签名工具</a></li><li><a href="//mac.aotu.io/" target="_blank" title="MAC全栈环境">MAC全栈环境</a></li></ul></div></div><div class="mod-side-sec favlinks"><div class="mod-side-sec-hd"><h2>友情链接</h2></div><div class="mod-side-sec-bd"><ul class="mod-side-list"><li><a href="https://jdc.jd.com" target="_blank" title="京东设计中心">JDC京东设计中心</a></li><li><a href="http://fex.baidu.com" target="_blank" title="百度Web前端研发部">百度FEX</a></li><li><a href="http://taobaofed.org" target="_blank" title="淘宝前端团队">淘宝FED</a></li><li><a href="http://tgideas.qq.com" target="_blank" title="腾讯互娱设计中心">TGIdeas</a></li><li><a href="http://isux.tencent.com" target="_blank" title="腾讯SNG设计中心">ISUX</a></li><li><a href="http://cdc.tencent.com" target="_blank" title="腾讯用户研究与体验设计中心">CDC</a></li><li><a href="http://ued.ctrip.com" target="_blank" title="携程设计委员会">携程UED</a></li></ul></div></div></aside></div></div><div class="mod-backtop" id="backTop"><i class="fa fa-long-arrow-up"></i></div><footer class="mod-ft" id="footer"><div class="grid"><ul class="mod-ft-links"><li><a href="/atom.xml"><i class="fa fa-rss"></i></a></li><li><a href="https://github.com/o2team/o2team.github.io" target="_blank"><i class="fa fa-github-alt"></i></a></li></ul><div class="mod-ft-sec mod-ft-copyright"><p>Designed by <a href="http://aotu.io" target="_blank">凹凸实验室</a> @<a target="_blank" href="http://jdc.jd.com">京东用户体验设计部</a></p><p>Copyright &copy; 2016. All Rights Reserved.</p><p><a href="http://www.miibeian.gov.cn/" target="_blank">粤ICP备15077732号-2</a></p></div></div></footer><script src="/js/bundle/core.js"></script><script>!function(){var t=document.createElement("script"),s=window.location.protocol.split(":")[0];"https"===s?t.src="https://zz.bdstatic.com/linksubmit/push.js":t.src="http://push.zhanzhang.baidu.com/push.js";var e=document.getElementsByTagName("script")[0];e.parentNode.insertBefore(t,e)}()</script><script>var _hmt=_hmt||[];!function(){var e=document.createElement("script");e.src="//hm.baidu.com/hm.js?e850b980d029480b092fdd7503c3f8de";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}()</script><style>#cnzz_stat_icon_1258539944{display:none}</style><script type="text/javascript">var cnzz_protocol="https:"==document.location.protocol?" https://":" http://";document.write(unescape("%3Cspan id='cnzz_stat_icon_1258539944'%3E%3C/span%3E%3Cscript src='"+cnzz_protocol+"s11.cnzz.com/z_stat.php%3Fid%3D1258539944' type='text/javascript'%3E%3C/script%3E"))</script></body></html>