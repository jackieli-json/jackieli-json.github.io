!function(t){function i(){var i=Util.getParam("o2layout")||"",s=i.split("-");s.length&&t("body").addClass(s.join(" "))}var s=t(window);t("#J_hdToggle").on("click",function(i){t(".mod-hd-main").toggleClass("mod-hd-main-expand")});var n=t("#backTop");s.on("scroll.backtop",Util.debounce(function(){s.scrollTop()>s.height()?n.show():n.hide()})),n.on("click",function(){return t("body,html").animate({scrollTop:0},500),!1});var a={init:function(){this.$form=t("#J_searchForm"),this.$input=t("#J_searchInput"),this.$trigger=t("#J_searchTrigger"),this.bindEvent()},bindEvent:function(){var i=this;this.$form.on("submit",function(s){var n=t.trim(i.$input.val());n||s.preventDefault()}),this.$trigger.on("click",function(s){var n=t(this).data("show");n||i.$input.focus(),i.$form.toggleClass("show"),t(this).data("show",!n)})}};a.init(),i();var r=200,o=window.innerWidth,h=320,e=0,d=0,c=150,u=function(t){return t*Math.PI/180},p=function(){return Math.sin(Math.floor(360*Math.random())*Math.PI/180)},z={obj:{x:e,y:d,z:c},dest:{x:0,y:0,z:1},dist:{x:0,y:0,z:200},ang:{cplane:0,splane:0,ctheta:0,stheta:0},zoom:1,disp:{x:o/2,y:h/2,z:0},upd:function(){z.dist.x=z.dest.x-z.obj.x,z.dist.y=z.dest.y-z.obj.y,z.dist.z=z.dest.z-z.obj.z,z.ang.cplane=-z.dist.z/Math.sqrt(z.dist.x*z.dist.x+z.dist.z*z.dist.z),z.ang.splane=z.dist.x/Math.sqrt(z.dist.x*z.dist.x+z.dist.z*z.dist.z),z.ang.ctheta=Math.sqrt(z.dist.x*z.dist.x+z.dist.z*z.dist.z)/Math.sqrt(z.dist.x*z.dist.x+z.dist.y*z.dist.y+z.dist.z*z.dist.z),z.ang.stheta=-z.dist.y/Math.sqrt(z.dist.x*z.dist.x+z.dist.y*z.dist.y+z.dist.z*z.dist.z)}},l={parts:{sz:function(t,i){return{x:t.x*i.x,y:t.y*i.y,z:t.z*i.z}},rot:{x:function(t,i){return{x:t.x,y:t.y*Math.cos(u(i.x))-t.z*Math.sin(u(i.x)),z:t.y*Math.sin(u(i.x))+t.z*Math.cos(u(i.x))}},y:function(t,i){return{x:t.x*Math.cos(u(i.y))+t.z*Math.sin(u(i.y)),y:t.y,z:-t.x*Math.sin(u(i.y))+t.z*Math.cos(u(i.y))}},z:function(t,i){return{x:t.x*Math.cos(u(i.z))-t.y*Math.sin(u(i.z)),y:t.x*Math.sin(u(i.z))+t.y*Math.cos(u(i.z)),z:t.z}}},pos:function(t,i){return{x:t.x+i.x,y:t.y+i.y,z:t.z+i.z}}},pov:{plane:function(t){return{x:t.x*z.ang.cplane+t.z*z.ang.splane,y:t.y,z:t.x*-z.ang.splane+t.z*z.ang.cplane}},theta:function(t){return{x:t.x,y:t.y*z.ang.ctheta-t.z*z.ang.stheta,z:t.y*z.ang.stheta+t.z*z.ang.ctheta}},set:function(t){return{x:t.x-z.obj.x,y:t.y-z.obj.y,z:t.z-z.obj.z}}},persp:function(t){return{x:t.x*z.dist.z/t.z*z.zoom,y:t.y*z.dist.z/t.z*z.zoom,z:t.z*z.zoom,p:z.dist.z/t.z}},disp:function(t,i){return{x:t.x+i.x,y:-t.y+i.y,z:t.z+i.z,p:t.p}},steps:function(t,i,s,n,a){var r=l.parts.sz(t,i);return r=l.parts.rot.x(r,s),r=l.parts.rot.y(r,s),r=l.parts.rot.z(r,s),r=l.parts.pos(r,n),r=l.pov.plane(r),r=l.pov.theta(r),r=l.pov.set(r),r=l.persp(r),r=l.disp(r,a)}};!function(){"use strict";var t=function(t){this.transIn={},this.transOut={},this.transIn.vtx=t.vtx,this.transIn.sz=t.sz,this.transIn.rot=t.rot,this.transIn.pos=t.pos};t.prototype.vupd=function(){this.transOut=l.steps(this.transIn.vtx,this.transIn.sz,this.transIn.rot,this.transIn.pos,z.disp)};var i=function(){this.vel=.04,this.lim=360,this.diff=200,this.initPos=100,this.toX=e,this.toY=d,this.go()};i.prototype.go=function(){this.canvas=document.getElementById("canv"),this.canvas.width=window.innerWidth,this.canvas.height=320,this.$=canv.getContext("2d"),this.$.globalCompositeOperation="source-over",this.varr=[],this.dist=[],this.calc=[];for(var t=0,i=r;t<i;t++)this.add();this.rotObj={x:0,y:0,z:0},this.objSz={x:o/5,y:h/5,z:o/5}},i.prototype.add=function(){this.varr.push(new t({vtx:{x:p(),y:p(),z:p()},sz:{x:0,y:0,z:0},rot:{x:20,y:-20,z:0},pos:{x:this.diff*Math.sin(360*Math.random()*Math.PI/180),y:this.diff*Math.sin(360*Math.random()*Math.PI/180),z:this.diff*Math.sin(360*Math.random()*Math.PI/180)}})),this.calc.push({x:360*Math.random(),y:360*Math.random(),z:360*Math.random()})},i.prototype.upd=function(){z.obj.x+=.05*(this.toX-z.obj.x),z.obj.y+=.05*(this.toY-z.obj.y)},i.prototype.draw=function(){this.$.clearRect(0,0,this.canvas.width,this.canvas.height),z.upd(),this.rotObj.x+=.1,this.rotObj.y+=.1,this.rotObj.z+=.1;for(var t=0;t<this.varr.length;t++){for(var i in this.calc[t])this.calc[t].hasOwnProperty(i)&&(this.calc[t][i]+=this.vel,this.calc[t][i]>this.lim&&(this.calc[t][i]=0));if(this.varr[t].transIn.pos={x:this.diff*Math.cos(this.calc[t].x*Math.PI/180),y:this.diff*Math.sin(this.calc[t].y*Math.PI/180),z:this.diff*Math.sin(this.calc[t].z*Math.PI/180)},this.varr[t].transIn.rot=this.rotObj,this.varr[t].transIn.sz=this.objSz,this.varr[t].vupd(),!(this.varr[t].transOut.p<0)){var s=this.$.createRadialGradient(this.varr[t].transOut.x,this.varr[t].transOut.y,this.varr[t].transOut.p,this.varr[t].transOut.x,this.varr[t].transOut.y,2*this.varr[t].transOut.p);this.$.globalCompositeOperation="lighter",s.addColorStop(0,"hsla(255, 255%, 255%, 1)"),s.addColorStop(.5,"hsla("+(t+2)+",85%, 40%,1)"),s.addColorStop(1,"hsla("+t+",85%, 40%,.5)"),this.$.fillStyle=s,this.$.beginPath(),this.$.arc(this.varr[t].transOut.x,this.varr[t].transOut.y,2*this.varr[t].transOut.p,0,2*Math.PI,!1),this.$.fill(),this.$.closePath()}}},i.prototype.anim=function(){window.requestAnimationFrame=function(){return window.requestAnimationFrame||function(t,i){window.setTimeout(t,1e3/60)}}();var t=function(){this.upd(),this.draw(),window.requestAnimationFrame(t)}.bind(this);window.requestAnimationFrame(t)},i.prototype.run=function(){this.anim(),document.getElementById("banner").addEventListener("mousemove",function(t){this.toX=(t.clientX-this.canvas.width/2)*-.8,this.toY=.8*(t.clientY-this.canvas.height/2)}.bind(this)),document.getElementById("banner").addEventListener("touchmove",function(t){t.preventDefault(),this.toX=(t.touches[0].clientX-this.canvas.width/2)*-.8,this.toY=.8*(t.touches[0].clientY-this.canvas.height/2)}.bind(this)),document.getElementById("banner").addEventListener("mousedown",function(t){for(var i=0;i<100;i++)this.add()}.bind(this)),document.getElementById("banner").addEventListener("touchstart",function(t){t.preventDefault();for(var i=0;i<100;i++)this.add()}.bind(this))};var s=new i;s.run()}(),window.addEventListener("resize",function(){canvas.width=o=window.innerWidth,canvas.height=h=320},!1)}(jQuery);